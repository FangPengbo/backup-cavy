import{B as e,E as l,r as a,o,e as d,g as r,h as u,w as s,i as t,t as c,f as n,L as m,C as i,p,j as f}from"./vendor.6c36e4e7.js";import{a as V,b,U as y,I as h}from"./index.236993a1.js";import{_}from"./index.a811416a.js";const g={name:"dataSourceTable",setup(){const a=e(0),o=l({sourceName:"",sourceType:"",sourceHost:"",page:1,size:10}),d=e([]),r=e(0),u=e(!1),s=l({sourceName:"",sourceType:"mysql",sourceHost:"",sourcePort:"",sourceUser:"",sourcePwd:""}),t=e(!1);let c=l({id:0,sourceName:"",sourceType:"",sourceHost:"",sourcePort:"",sourceUser:"",sourcePwd:""});const n=()=>{V(o).then((e=>{d.value=e.result.records,r.value=e.result.total||50}))};n();return{deleteId:a,query:o,tableData:d,pageTotal:r,editVisible:t,addVisible:u,form:c,addForm:s,handleAdd:()=>{u.value=!0},handleSearch:()=>{o.page_num=1,n()},handlePageChange:e=>{o.page=e,n()},handleDelete:(e,l)=>{a.value=l.id,m.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{b(a.value).then((e=>{"0"===e.code?(i.success("删除数据源成功"),n()):i.error("删除数据源失败"+e.message)})),a.value=0})).catch((()=>{a.value=0}))},handleEdit:(e,l)=>{Object.keys(c).forEach((e=>{c[e]=l[e]})),t.value=!0},saveEdit:()=>{y(c).then((e=>{"0"===e.code?(i.success("修改数据源成功"),n()):i.error("修改数据源失败"+e.message)})),t.value=!1},saveAdd:()=>{console.log(s),h(s).then((e=>{"0"===e.code?(i.success("新增数据源成功"),n()):i.error("新增数据源失败"+e.message)})),u.value=!1},filterType:(e,l)=>l.sourceType===e}}},v={class:"crumbs"},w=(e=>(p("data-v-3cd20745"),e=e(),f(),e))((()=>r("i",{class:"el-icon-lx-cascades"},null,-1))),U={class:"container"},C={class:"handle-box"},k={class:"pagination"},T={class:"dialog-footer"},q={class:"dialog-footer"};var P=_(g,[["render",function(e,l,m,i,p,f){const V=a("el-breadcrumb-item"),b=a("el-breadcrumb"),y=a("el-option"),h=a("el-select"),_=a("el-input"),g=a("el-button"),P=a("el-table-column"),F=a("el-tag"),x=a("el-table"),H=a("el-pagination"),N=a("el-form-item"),S=a("el-form"),L=a("el-dialog");return o(),d("div",null,[r("div",v,[u(b,{separator:"/"},{default:s((()=>[u(V,null,{default:s((()=>[w,t(" 数据源列表 ")])),_:1})])),_:1})]),r("div",U,[r("div",C,[u(h,{modelValue:i.query.sourceType,"onUpdate:modelValue":l[0]||(l[0]=e=>i.query.sourceType=e),placeholder:"类型",class:"handle-input mr10"},{default:s((()=>[u(y,{key:"MYSQL",label:"MYSQL",value:"MYSQL"})])),_:1},8,["modelValue"]),u(_,{modelValue:i.query.sourceName,"onUpdate:modelValue":l[1]||(l[1]=e=>i.query.sourceName=e),placeholder:"名称",class:"handle-input mr10"},null,8,["modelValue"]),u(_,{modelValue:i.query.sourceHost,"onUpdate:modelValue":l[2]||(l[2]=e=>i.query.sourceHost=e),placeholder:"地址",class:"handle-input mr10"},null,8,["modelValue"]),u(g,{type:"primary",icon:"el-icon-search",onClick:i.handleSearch},{default:s((()=>[t("搜索")])),_:1},8,["onClick"]),u(g,{type:"primary",icon:"el-icon-plus",onClick:i.handleAdd},{default:s((()=>[t("新增")])),_:1},8,["onClick"])]),u(x,{data:i.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:s((()=>[u(P,{prop:"id",label:"ID",align:"center"}),u(P,{prop:"sourceName",label:"名称"}),u(P,{prop:"sourceType",label:"类型",filters:[{text:"MYSQL",value:"mysql"}],"filter-method":i.filterType,"filter-placement":"bottom-end"},{default:s((e=>[u(F,{type:"mysql"===e.row.sourceType?"success":"warning"},{default:s((()=>[t(c(e.row.sourceType),1)])),_:2},1032,["type"])])),_:1},8,["filter-method"]),u(P,{prop:"sourceHost",label:"地址"}),u(P,{prop:"sourcePort",label:"端口"}),u(P,{label:"操作",width:"180",align:"center"},{default:s((e=>[u(g,{icon:"el-icon-edit",onClick:l=>i.handleEdit(e.$index,e.row)},null,8,["onClick"]),u(g,{icon:"el-icon-delete",class:"red",onClick:l=>i.handleDelete(e.$index,e.row)},null,8,["onClick"])])),_:1})])),_:1},8,["data"]),r("div",k,[u(H,{background:"",layout:"total, prev, pager, next","current-page":i.query.page,"page-size":i.query.size,total:i.pageTotal,onCurrentChange:i.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),n(" 编辑弹出框 "),u(L,{title:"编辑",modelValue:i.editVisible,"onUpdate:modelValue":l[10]||(l[10]=e=>i.editVisible=e),width:"30%"},{footer:s((()=>[r("span",T,[u(g,{onClick:l[9]||(l[9]=e=>i.editVisible=!1)},{default:s((()=>[t("取 消")])),_:1}),u(g,{type:"primary",onClick:i.saveEdit},{default:s((()=>[t("确 定")])),_:1},8,["onClick"])])])),default:s((()=>[u(S,{"label-width":"70px"},{default:s((()=>[u(N,{label:"名称"},{default:s((()=>[u(_,{modelValue:i.form.sourceName,"onUpdate:modelValue":l[3]||(l[3]=e=>i.form.sourceName=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"类型"},{default:s((()=>[u(h,{modelValue:i.form.sourceType,"onUpdate:modelValue":l[4]||(l[4]=e=>i.form.sourceType=e),placeholder:"请选择"},{default:s((()=>[u(y,{key:"bbk",label:"MYSQL",value:"mysql"})])),_:1},8,["modelValue"])])),_:1}),u(N,{label:"地址"},{default:s((()=>[u(_,{modelValue:i.form.sourceHost,"onUpdate:modelValue":l[5]||(l[5]=e=>i.form.sourceHost=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"端口"},{default:s((()=>[u(_,{modelValue:i.form.sourcePort,"onUpdate:modelValue":l[6]||(l[6]=e=>i.form.sourcePort=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"账户"},{default:s((()=>[u(_,{modelValue:i.form.sourceUser,"onUpdate:modelValue":l[7]||(l[7]=e=>i.form.sourceUser=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"密码"},{default:s((()=>[u(_,{type:"password",modelValue:i.form.sourcePwd,"onUpdate:modelValue":l[8]||(l[8]=e=>i.form.sourcePwd=e),"show-password":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),n(" 新增数据源 "),u(L,{title:"新增数据源",modelValue:i.addVisible,"onUpdate:modelValue":l[18]||(l[18]=e=>i.addVisible=e),width:"30%"},{footer:s((()=>[r("span",q,[u(g,{onClick:l[17]||(l[17]=e=>i.addVisible=!1)},{default:s((()=>[t("取 消")])),_:1}),u(g,{type:"primary",onClick:i.saveAdd},{default:s((()=>[t("确 定")])),_:1},8,["onClick"])])])),default:s((()=>[u(S,{"label-width":"70px"},{default:s((()=>[u(N,{label:"名称"},{default:s((()=>[u(_,{modelValue:i.addForm.sourceName,"onUpdate:modelValue":l[11]||(l[11]=e=>i.addForm.sourceName=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"类型",prop:"region"},{default:s((()=>[u(h,{modelValue:i.addForm.sourceType,"onUpdate:modelValue":l[12]||(l[12]=e=>i.addForm.sourceType=e),placeholder:"请选择"},{default:s((()=>[u(y,{key:"mysql",label:"MYSQL",value:"mysql"})])),_:1},8,["modelValue"])])),_:1}),u(N,{label:"地址"},{default:s((()=>[u(_,{modelValue:i.addForm.sourceHost,"onUpdate:modelValue":l[13]||(l[13]=e=>i.addForm.sourceHost=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"端口"},{default:s((()=>[u(_,{modelValue:i.addForm.sourcePort,"onUpdate:modelValue":l[14]||(l[14]=e=>i.addForm.sourcePort=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"账户"},{default:s((()=>[u(_,{modelValue:i.addForm.sourceUser,"onUpdate:modelValue":l[15]||(l[15]=e=>i.addForm.sourceUser=e)},null,8,["modelValue"])])),_:1}),u(N,{label:"密码"},{default:s((()=>[u(_,{type:"password",modelValue:i.addForm.sourcePwd,"onUpdate:modelValue":l[16]||(l[16]=e=>i.addForm.sourcePwd=e),"show-password":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}],["__scopeId","data-v-3cd20745"]]);export{P as default};
